## <center>Metric Learning</center>

 中文翻译为度量学习，度量（metric） 在数学中的含义是定义一个集合中元素之间距离的函数。一个具有度量空间的集合称为度量空间。对于深度学习中的度量学习（deep metric learning）主要的目标就是将训练样本投影到一个比较好的度量空间也就是所谓的embedding space。接下来要做的事就是在这个embedding空间中对样本进行分类，目标就是减小或者抑制同类样本之间的距离，同时增大不同样本之间的距离。

可能大家会困惑，现在端到端的神经网络这么强大，为什么还要使用距离度量的方式来进行分类呢？主要的原因就是当有新的类别加入进来的时候，端到端的网络就需要重新设计网络结构，然后重新训练。但是对于度量学习的方式，我们学到将样本空间投影到embedding空间的网络之后，对于新加进来的类别也是适用的（同一任务的话基本适用或者在当前的基础上进行微调就可以了），然后在embedding空间对进行一个距离度量的分类（或者适用相似性函数）。这样对整个系统的泛化能力会有比较大的提升。

> **科普**
>
> close-set，就是所有的测试集都在训练集中出现过。所以预测结果是图片的ID，如果想要测试两张图片是否是同一个，那么就看这两张图片的预测ID是否一样即可。
> open-set，就是测试的图片并没有在训练集中出现过，那么每张测试图片的预测结果是特征向量，如果想要比较两张图片的人脸是否属于同一个人，需要测试图像特征向量的距离。

度量学习主要分为两种：1）线性方法； 2）非线性方法。 传统的线性学习方法主要是为了学习一个马氏距离，**马氏距离**（Mahalanobis distance）可以这样理解：我们在计算高维空间的时候认为所有维度对最终结果的影响是一样的，但是马氏距离认为这个影响是不一样。





### reference

[度量学习---综述]( https://blog.csdn.net/xys430381_1/article/details/90705421 )这个里面的tri_loss还可以，但是没有说anchor是怎么来的。

[常见的距离度量和损失函数](https://blog.csdn.net/qq_16234613/article/details/81210320)